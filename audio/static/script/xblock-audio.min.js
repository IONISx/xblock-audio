function AudioXBlockStudio(a,b){var c=new AudioXBlock.Server(a,b),d=new AudioXBlock.StudioView(c,a,b);d.render()}function AudioXBlockStudent(a,b){var c=new AudioXBlock.Server(a,b),d=new AudioXBlock.StudentView(c,a,b);d.render()}"undefined"!=typeof AudioXBlock&&AudioXBlock||(AudioXBlock={}),AudioXBlock.Server=function(){this.constructor.apply(this,arguments)},AudioXBlock.Server.prototype={constructor:function(a,b){this.runtime=a,this.element=b},url:function(a){return this.runtime.handlerUrl(this.element,a)},edit:function(a){var b=this.url("edit"),c=JSON.stringify(a);return $.Deferred(function(a){$.ajax({type:"POST",url:b,data:c}).done(function(b){b.success?a.resolve():a.rejectWith(this,[b.msg])}).fail(function(){a.rejectWith(this,["This problem could not be saved."])})}).promise()}},AudioXBlock.StudioView=function(){this.constructor.apply(this,arguments)},AudioXBlock.StudioView.prototype={constructor:function(a,b,c){this.runtime=b,this.server=a,this.element=$(c)},save:function(){var a=this.element.find("#settings-tab"),b=a.data("metadata");this.element.find(".metadata_entry").each(function(){var a=$(this).find(".setting-input");b[a.data("field-name")].value=a.val()}),this.runtime.notify("save",{state:"start"});var c=this;this.server.edit({metadata:b}).done(function(){c.runtime.notify("save",{state:"end"}),a.data("metadata",b)}).fail(function(a){c.showError(a)})},cancel:function(){this.runtime.notify("cancel",{})},showError:function(a){this.runtime.notify("error",{msg:a})},setupEvents:function(){var a=this;this.element.on("click",".save-button",function(){a.save()}),this.element.on("click",".cancel-button",function(){a.cancel()})},render:function(){this.setupEvents()}},AudioXBlock.StudentView=function(){this.constructor.apply(this,arguments)},AudioXBlock.StudentView.prototype={constructor:function(a,b,c){this.runtime=b,this.server=a,this.element=$(c)},render:function(){}};